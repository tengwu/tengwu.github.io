#+OPTIONS: author:nil ^:{}
#+HUGO_BASE_DIR: ../../../..
#+HUGO_SECTION: post/2023/04
#+HUGO_CUSTOM_FRONT_MATTER: :toc true
#+HUGO_AUTO_SET_LASTMOD: t
#+HUGO_DRAFT: false
#+DATE: [2023-04-06 Thu 20:45]
#+TITLE: 分支与循环
#+HUGO_TAGS: 编译 LLVM
#+HUGO_CATEGORIES: 编译 LLVM
#+STARTUP: inlineimages

* Clean code

=toy-compiler= 编译器目前的类图是这样的:
 #+BEGIN_SRC plantuml :exports results :file ../../../../static/images/arch_v0.png
   @startuml
   abstract class "Node"
   abstract class "NExpression"
   abstract class "NStatement"
   class NInteger
   class NDouble
   class NIdentifier
   class NInteger
   class NMethodCall
   class NBinaryOperator
   class NAssignment
   class NBlock
   class NIFBlock
   class NIFBlocks
   class NBranchStatement
   class NExpressionStatement
   class NReturnStatement
   class NVariableDeclaration
   class NExternDeclaration
   class NFunctionDeclaration

   Node <|-- NExpression
   Node <|-- NStatement

   NExpression <|-- NInteger
   NExpression <|-- NDouble
   NExpression <|-- NIdentifier
   NExpression <|-- NMethodCall
   NExpression <|-- NBinaryOperator
   NExpression <|-- NAssignment
   NExpression <|-- NBlock

   NBlock <|-- NIFBlock
   NBlock <|-- NIFBlocks

   NStatement <|-- NBranchStatement
   NStatement <|-- NExpressionStatement
   NStatement <|-- NReturnStatement
   NStatement <|-- NVariableDeclaration
   NStatement <|-- NExternDeclaration
   NStatement <|-- NFunctionDeclaration
   @enduml
 #+END_SRC

 [[file:/images/arch_v0.png]]

* 分支
 为了实现分支语句,我们创建一个新的 =NBranchStatement= 类,这个类继承自 =NStatement= 类.每一条分支语句( =NBranchStatement= )对象应该包含若干个 =if= 语句块( =NIFBlock= )和至多一个 =else= 语句块( =NBlock= ).而每个 =NIFBlock= 中应包含一个条件表达式( =NExpression= )和一个基本语句块( =NBlock= ).

 到这里,可以发现上述项目结构至少存在一个问题: =NIFBlock= 和 =NBlock= 不应该是继承关系而应该是组合关系.

 所以将代码中涉及到 =NIFBlock= 的类进行改进.修改后的类图如下: +稍后放送...+.

* 循环
